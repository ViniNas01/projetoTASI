<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Meus ServiÃ§os - ContrataFÃ¡cil</title>
  <link rel="stylesheet" href="/style/style.css" />
  <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body class="home-body">

  <header class="top-bar">
  <div class="logo">
    ğŸ› ï¸ <span>ContrataFÃ¡cil</span>
  </div>

  <div class="perfil-area">
    <div class="perfil" id="perfil-toggle">
      <i data-lucide="user"></i>
      <span><%= cliente.nome %></span>
      <i data-lucide="chevron-down" class="seta"></i>
    </div>

    <div class="dropdown" id="perfil-dropdown">
      <a href="/home">Home</a>
      <a href="/meus-servicos">Meus ServiÃ§os</a>
      <a href="/logout">Sair</a>
    </div>
  </div>
</header>


  <!-- ConteÃºdo principal -->
  <main class="content meus-servicos">
    <h2>ğŸ“‹ Meus ServiÃ§os Contratados</h2>

    <% if (typeof success !== 'undefined' && success) { %>
      <div class="success"><%= success %></div>
    <% } %>

    <% if (typeof error !== 'undefined' && error) { %>
      <div class="error"><%= error %></div>
    <% } %>

    <% if (contratos.length === 0) { %>
      <p class="nenhum-servico">VocÃª ainda nÃ£o contratou nenhum serviÃ§o.</p>
    <% } else { %>
      <div class="cards-servicos">
        <% contratos.forEach(c => { %>
          <div class="card-servico">
            <div class="card-info">
              <h3><%= c.profissional_nome %></h3>
              <p class="categoria"><%= c.categoria %></p>
              <p class="detalhe">ğŸ—“ï¸ <%= new Date(c.data_contratacao).toLocaleString('pt-BR') %></p>
              <p class="detalhe">ğŸ“Œ Status: <%= c.status %></p>

              <div class="acoes-servico" style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap;">
                <a href="/contratos/<%= c.id %>/editar" class="btn-contratar" style="background:#ffd166;color:#222;padding:8px 12px;">Editar</a>

                <form action="/contratos/<%= c.id %>/excluir" method="POST" onsubmit="return confirm('Tem certeza que deseja excluir este serviÃ§o?');" style="display:inline-block;">
                  <button type="submit" class="btn-contratar" style="background:#ff5c5c;">Excluir</button>
                </form>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
    <% } %>

    <a href="/home" class="voltar">â† Voltar</a>
  </main>

  <script>lucide.createIcons();</script>

  <script>
  lucide.createIcons();

  // Dropdown do perfil
  const perfilToggle = document.getElementById('perfil-toggle');
  const dropdown = document.getElementById('perfil-dropdown');

  perfilToggle.addEventListener('click', () => {
    dropdown.classList.toggle('mostrar');
    perfilToggle.classList.toggle('ativo');
  });

  document.addEventListener('click', (e) => {
    if (!e.target.closest('.perfil-area')) {
      dropdown.classList.remove('mostrar');
      perfilToggle.classList.remove('ativo');
    }
  });
</script>

</body>
</html>
